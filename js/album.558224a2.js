(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["album"],{ee18:function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{attrs:{id:"album"}},[i("h1",{staticClass:"text-center"},[e._v("我的相簿")]),i("hr"),i("h2",[e._v("檔案上傳")]),i("br"),i("b-form",{on:{submit:e.submit}},[i("b-form-file",{attrs:{state:e.state,placeholder:"選擇檔案或拖曳至此","drop-placeholder":"拖曳至此",required:"","browse-text":"瀏覽",accept:"image/*"},on:{input:e.validateFile},model:{value:e.file,callback:function(t){e.file=t},expression:"file"}}),i("p",{staticClass:"text-danger"},[e._v("僅支援 1MB 以下的圖片")]),i("b-form-textarea",{attrs:{state:e.textstate,placeholder:"相片說明",rows:"3","max-rows":"6",maxlength:"200"},on:{input:e.validateText},model:{value:e.description,callback:function(t){e.description=t},expression:"description"}}),i("br"),i("b-button",{attrs:{type:"submit"}},[e._v("上傳")])],1),i("hr"),i("Photoswipe",[i("b-row",e._l(e.images,(function(t,a){return i("b-col",{key:a,attrs:{cols:"12",md:"6",lg:"3"}},[i("b-card",[i("b-card-img",{directives:[{name:"pswp",rawName:"v-pswp",value:t,expression:"image"}],attrs:{src:t.src}}),i("b-card-body",[t.edit?i("b-btn",{attrs:{variant:"danger"},on:{click:function(i){return e.cancel(t)}}},[e._v("取消")]):i("b-btn",{attrs:{variant:"success"},on:{click:function(i){return e.edit(t)}}},[e._v("編輯")]),t.edit?i("b-btn",{attrs:{variant:"success"},on:{click:function(i){return e.update(t)}}},[e._v("更新")]):i("b-btn",{attrs:{variant:"danger"},on:{click:function(i){return e.del(t,a)}}},[e._v("刪除")]),i("hr"),t.edit?i("b-form-textarea",{model:{value:t.model,callback:function(i){e.$set(t,"model",i)},expression:"image.model"}}):i("pre",[e._v(e._s(t.title))])],1)],1)],1)})),1)],1)],1)},s=[],l={name:"album",data(){return{file:null,description:"",state:null,textstate:null,images:[]}},computed:{user(){return this.$store.getters.user}},methods:{validateFile(){null!==this.file&&(this.file.size>=1048576||!this.file.type.includes("image")?(this.state=!1,this.file=null):this.state=!0)},validateText(){this.description.length>200?this.textstate=!1:this.textstate=!0},submit(e){if(e.preventDefault(),null===this.file||this.file.size>=1048576||!this.file.type.includes("image"))alert("檔案格式不符");else{const e=new FormData;e.append("image",this.file),e.append("description",this.description),this.axios.post("https://reneealbum1.herokuapp.com/file",e,{headers:{"Content-Type":"multipart/form-data"}}).then(e=>{this.images.push({title:this.description,src:"https://reneealbum1.herokuapp.com/file/"+e.data.name,_id:e.data._id,edit:!1,model:e.data.name}),this.file=null,this.description=""}).catch(e=>{alert(e.response.data.message)})}},edit(e){e.edit=!0,e.model=e.title},update(e){this.axios.patch("https://reneealbum1.herokuapp.com/file/"+e._id,{description:e.model}).then(t=>{e.edit=!1,e.title=e.model}).catch(()=>{alert("發生錯誤")})},cancel(e){e.edit=!1,e.model=e.title},del(e,t){this.axios.delete("https://reneealbum1.herokuapp.com/file/"+e._id).then(e=>{this.images.splice(t,1)}).catch(()=>{alert("發生錯誤")})}},mounted(){this.axios.get("https://reneealbum1.herokuapp.com/album/"+this.user).then(e=>{this.images=e.data.result.map(e=>({title:e.description,src:"https://reneealbum1.herokuapp.com/file/"+e.name,_id:e._id,edit:!1,model:e.name}))}).catch(()=>{alert("發生錯誤")})}},r=l,n=i("2877"),o=Object(n["a"])(r,a,s,!1,null,null,null);t["default"]=o.exports}}]);
//# sourceMappingURL=album.558224a2.js.map